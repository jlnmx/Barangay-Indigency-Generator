<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="styles.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .chart-container {
            width: 60%;
            margin: auto;
        }
        .data-summary {
            margin: 20px auto;
            width: 60%;
            text-align: left;
        }
        .data-summary h3 {
            margin-bottom: 5px;
        }
        .data-summary ul {
            list-style: none;
            padding: 0;
        }
        .data-summary ul li {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Analytics</h1>
        <p><strong>Total Number of Residents:</strong> {{ total_residents }}</p>

        <div class="data-summary">
            <h3>Purpose Distribution</h3>
            <ul>
                {% for label, count, percentage in zip(purpose_labels, purpose_counts, purpose_percentages) %}
                    <li>{{ label }}: {{ count }} ({{ percentage }}%)</li>
                {% endfor %}
            </ul>
        </div>

        <div class="chart-container">
            <canvas id="purposeChart"></canvas>
        </div>

        <div class="data-summary">
            <h3>Occupation Distribution</h3>
            <ul>
                {% for label, count, percentage in zip(occupation_labels, occupation_counts, occupation_percentages) %}
                    <li>{{ label }}: {{ count }} ({{ percentage }}%)</li>
                {% endfor %}
            </ul>
        </div>

        <div class="chart-container">
            <canvas id="occupationChart"></canvas>
        </div>

        <a href="/" style="display: block; text-align: center; margin: 20px;">Back</a>
    </div>

    <script>
        const purposeLabels = {{ purpose_labels|tojson }};
        const purposeCounts = {{ purpose_counts|tojson }};
    
        const purposeCtx = document.getElementById('purposeChart').getContext('2d');
        new Chart(purposeCtx, {
            type: 'pie',
            data: {
                labels: purposeLabels,
                datasets: [{
                    data: purposeCounts,
                    backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40'],
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        position: 'top',
                    }
                }
            }
        });
    
        const occupationLabels = {{ occupation_labels|tojson }};
        const occupationCounts = {{ occupation_counts|tojson }};
    
        const occupationCtx = document.getElementById('occupationChart').getContext('2d');
        new Chart(occupationCtx, {
            type: 'bar',
            data: {
                labels: occupationLabels,
                datasets: [{
                    label: 'Number of Residents',
                    data: occupationCounts,
                    backgroundColor: '#36A2EB',
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                },
                plugins: {
                    legend: {
                        display: false,
                    }
                }
            }
        });
    </script>
    
</body>
</html>
